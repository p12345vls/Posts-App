<% include ../partials/headInfoShare%>

<nav class="navbar navbar-light navbar-expand-lg fixed-top bg-white clean-navbar">

    <div class="container"><a class="navbar-brand logo" href="/"><img src="/assets/img/logo-hp.png" style="height: 40px;width: 45px;"></a>
        <h3 class="title-mobile letter-spacing mt-2 text-black ">New Post</h3>
        <button data-toggle="collapse" class="navbar-toggler " data-target="#navcol-1">
            <span class="sr-only ">Toggle navigation</span>
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navcol-1">
            <h3 class="title-desktop letter-spacing mt-2 m-auto text-black ">Add a New Post</h3>
        </div>
    </div>

</nav>


<main class="page mt-n5">

    <% if (typeof message != "undefined"){ %>
        <div class="container-message text-center flash" style="z-index: 2">
            <div id="warning-alert" class="alert alert-warning alert-dismissible fade show" role="alert">
                <%= message %>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
    <% } %>



    <section class="clean-block clean-form dark ">
        <div class="container">
            <div class="block-heading">
                <!--<h2 id="header-form" class="text-info">Add a New Post</h2>-->
                Use the form below to add a new post
            </div>
            <form id="post_form" class="" action="/posts " method="POST" enctype="multipart/form-data">
                <h3 id="loading-message" class="text-center text-warning"></h3>
                <!--add a title-->
                <div class="form-group">
                    <input type="text" id="title-for-post" class="form-control hover" name="post[name]" maxlength="30" placeholder="title" required></div>
                <!--select image or video-->
                <div class=" form-group ">
                    <label for="files" class="btn btn-outline-secondary btn-sm">
                        Image or Video<em><small> (up to 10MB)</small></em>
                    </label><small><span id="url" class="ml-2"></span></small>
                    <input id='files' type="file"  class="d-none" name="image" accept="image/*;video/*" required >
                </div>
                <!--text area for description-->
                <div class="hover form-group ">
                            <textarea type="text" id="desc" class="form-control" name="post[description]"
                                      cols="100"
                                      rows="3" required></textarea>
                    <label class="form-control-placeholder"  for="description">description</label>
                </div>

                <div class="form-group">
                    <button id='btn' class="btn btn-primary btn-block" type="submit">Submit </button>
                </div>


                    <div id="loading" class="text-center "></div>


            </form>
        </div>
    </section>
</main>

<footer class="page-footer dark position-absolute" style="bottom:0; left: 0;right:0;">
    <div class="footer-copyright">
        <p>Â© 2019 by the Hellenic American Hippocratic Orthopaedic Society</p>
    </div>
</footer>


<script>

    // show to the user that the image or video is required
    document.querySelector('#btn').addEventListener('click', (event) => {
        if(document.querySelector('#desc').value!==''&&
            document.querySelector('#title-for-post').value!==''){

            if(document.querySelector('#files').value===''){
                alert('please enter an image or a video')
            } else {
                document.querySelector('#loading').innerHTML= '<i  class="fas fa-sync fa-spin text-secondary fa-lg">' +
                    '</i><br><p>please be patient this may take up to 45 seconds</p>';
            }
        }

    });

    // add the text of the selected file next to 'select image'
    document.querySelector('#files').addEventListener('change', (event) => {
        let url = document.querySelector('#files').value;
        document.querySelector('#url').innerHTML = url.substring(url.lastIndexOf('\\')+1);
    });




</script>

<script>
    document.querySelector('title').innerText = "Add Post"
</script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.js"></script>
<script src="assets/js/smoothproducts.min.js"></script>
<script src="assets/js/theme.js"></script>
<% include ../partials/footer %>
</body>
</html>